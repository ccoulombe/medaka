

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>medaka package &mdash; Medaka 0.3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="History and Future Directions" href="future.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Medaka
          

          
          </a>

          
            
            
              <div class="version">
                0.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="walkthrough.html">Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="future.html">History and Future Directions</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">medaka package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka.common">medaka.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka.compress">medaka.compress module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka.features">medaka.features module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka.inference">medaka.inference module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka.labels">medaka.labels module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka.medaka">medaka.medaka module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka.stitch">medaka.stitch module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka.tview">medaka.tview module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-medaka">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Medaka</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>medaka package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/medaka.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="medaka-package">
<h1>medaka package<a class="headerlink" href="#medaka-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-medaka.common">
<span id="medaka-common-module"></span><h2>medaka.common module<a class="headerlink" href="#module-medaka.common" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="medaka.common.AlignPos">
<em class="property">class </em><code class="descclassname">medaka.common.</code><code class="descname">AlignPos</code><span class="sig-paren">(</span><em>qpos</em>, <em>qbase</em>, <em>rpos</em>, <em>rbase</em><span class="sig-paren">)</span><a class="headerlink" href="#medaka.common.AlignPos" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="medaka.common.AlignPos.qbase">
<code class="descname">qbase</code><a class="headerlink" href="#medaka.common.AlignPos.qbase" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.AlignPos.qpos">
<code class="descname">qpos</code><a class="headerlink" href="#medaka.common.AlignPos.qpos" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.AlignPos.rbase">
<code class="descname">rbase</code><a class="headerlink" href="#medaka.common.AlignPos.rbase" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.AlignPos.rpos">
<code class="descname">rpos</code><a class="headerlink" href="#medaka.common.AlignPos.rpos" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="medaka.common.ComprAlignPos">
<code class="descclassname">medaka.common.</code><code class="descname">ComprAlignPos</code><a class="headerlink" href="#medaka.common.ComprAlignPos" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#medaka.common.AlignPos" title="medaka.common.AlignPos"><code class="xref py py-class docutils literal notranslate"><span class="pre">medaka.common.AlignPos</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="medaka.common.LabelledPileup">
<em class="property">class </em><code class="descclassname">medaka.common.</code><code class="descname">LabelledPileup</code><span class="sig-paren">(</span><em>pileups</em>, <em>labels</em>, <em>ref_seq</em><span class="sig-paren">)</span><a class="headerlink" href="#medaka.common.LabelledPileup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="medaka.common.LabelledPileup.labels">
<code class="descname">labels</code><a class="headerlink" href="#medaka.common.LabelledPileup.labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.LabelledPileup.pileups">
<code class="descname">pileups</code><a class="headerlink" href="#medaka.common.LabelledPileup.pileups" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.LabelledPileup.ref_seq">
<code class="descname">ref_seq</code><a class="headerlink" href="#medaka.common.LabelledPileup.ref_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="medaka.common.Pileup">
<em class="property">class </em><code class="descclassname">medaka.common.</code><code class="descname">Pileup</code><span class="sig-paren">(</span><em>bam</em>, <em>ref_name</em>, <em>reads</em>, <em>positions</em><span class="sig-paren">)</span><a class="headerlink" href="#medaka.common.Pileup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="medaka.common.Pileup.bam">
<code class="descname">bam</code><a class="headerlink" href="#medaka.common.Pileup.bam" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Pileup.positions">
<code class="descname">positions</code><a class="headerlink" href="#medaka.common.Pileup.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Pileup.reads">
<code class="descname">reads</code><a class="headerlink" href="#medaka.common.Pileup.reads" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Pileup.ref_name">
<code class="descname">ref_name</code><a class="headerlink" href="#medaka.common.Pileup.ref_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="medaka.common.Region">
<em class="property">class </em><code class="descclassname">medaka.common.</code><code class="descname">Region</code><span class="sig-paren">(</span><em>ref_name</em>, <em>start</em>, <em>end</em><span class="sig-paren">)</span><a class="headerlink" href="#medaka.common.Region" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="medaka.common.Region.end">
<code class="descname">end</code><a class="headerlink" href="#medaka.common.Region.end" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Region.ref_name">
<code class="descname">ref_name</code><a class="headerlink" href="#medaka.common.Region.ref_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Region.start">
<code class="descname">start</code><a class="headerlink" href="#medaka.common.Region.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="medaka.common.Sample">
<em class="property">class </em><code class="descclassname">medaka.common.</code><code class="descname">Sample</code><span class="sig-paren">(</span><em>ref_name</em>, <em>features</em>, <em>labels</em>, <em>ref_seq</em>, <em>positions</em>, <em>label_probs</em><span class="sig-paren">)</span><a class="headerlink" href="#medaka.common.Sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="medaka.common.Sample.features">
<code class="descname">features</code><a class="headerlink" href="#medaka.common.Sample.features" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Sample.label_probs">
<code class="descname">label_probs</code><a class="headerlink" href="#medaka.common.Sample.label_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Sample.labels">
<code class="descname">labels</code><a class="headerlink" href="#medaka.common.Sample.labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Sample.positions">
<code class="descname">positions</code><a class="headerlink" href="#medaka.common.Sample.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Sample.ref_name">
<code class="descname">ref_name</code><a class="headerlink" href="#medaka.common.Sample.ref_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="medaka.common.Sample.ref_seq">
<code class="descname">ref_seq</code><a class="headerlink" href="#medaka.common.Sample.ref_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="medaka.common.ThreadsafeIter">
<em class="property">class </em><code class="descclassname">medaka.common.</code><code class="descname">ThreadsafeIter</code><span class="sig-paren">(</span><em>it</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#ThreadsafeIter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.ThreadsafeIter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Takes an iterator and makes it thread-safe by
serializing call to <cite>next</cite> method.</p>
<p><a class="reference external" href="http://anandology.com/blog/using-iterators-and-generators/">http://anandology.com/blog/using-iterators-and-generators/</a></p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.chain_thread_safe">
<code class="descclassname">medaka.common.</code><code class="descname">chain_thread_safe</code><span class="sig-paren">(</span><em>*gens</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#chain_thread_safe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.chain_thread_safe" title="Permalink to this definition">¶</a></dt>
<dd><p>Threadsafe version of itertools.chain</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.chunk_sample">
<code class="descclassname">medaka.common.</code><code class="descname">chunk_sample</code><span class="sig-paren">(</span><em>sample</em>, <em>chunk_len=1000</em>, <em>overlap=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#chunk_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.chunk_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Rechunk chunks of pileup into smaller overlapping chunks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pileup_gen</strong> – generator of (pileups, labels);
pileups: a list of <cite>Pileup</cite> objects
labels: array of truth labels or <cite>None</cite>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body">(pileups, labels)
pileups: a list of <cite>Pileup</cite> objects
labels: array of truth labels or <cite>None</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.chunk_samples">
<code class="descclassname">medaka.common.</code><code class="descname">chunk_samples</code><span class="sig-paren">(</span><em>samples</em>, <em>chunk_len=1000</em>, <em>overlap=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#chunk_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.chunk_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Return generator of chunked samples</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.decode_sample_name">
<code class="descclassname">medaka.common.</code><code class="descname">decode_sample_name</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#decode_sample_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.decode_sample_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode a the result of <cite>encode_sample_name</cite> into a dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> – <cite>Sample</cite> object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dict.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.encode_sample_name">
<code class="descclassname">medaka.common.</code><code class="descname">encode_sample_name</code><span class="sig-paren">(</span><em>sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#encode_sample_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.encode_sample_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode a <cite>Sample</cite> object into a str key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sample</strong> – <cite>Sample</cite> object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">str.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.gen_train_batch">
<code class="descclassname">medaka.common.</code><code class="descname">gen_train_batch</code><span class="sig-paren">(</span><em>xy_gen</em>, <em>batch_size</em>, <em>name=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#gen_train_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.gen_train_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield training batches.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.get_common_index">
<code class="descclassname">medaka.common.</code><code class="descname">get_common_index</code><span class="sig-paren">(</span><em>arrays</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#get_common_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.get_common_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a common index for a list of arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arrays</strong> – input arrays of an indentical type.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">array of index.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.get_pairs">
<code class="descclassname">medaka.common.</code><code class="descname">get_pairs</code><span class="sig-paren">(</span><em>aln</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#get_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.get_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return generator of pairs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>aln</strong> – <cite>pysam.AlignedSegment</cite> object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">generator of <cite>ComprAlignPos</cite> objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.get_pairs_with_hp_len">
<code class="descclassname">medaka.common.</code><code class="descname">get_pairs_with_hp_len</code><span class="sig-paren">(</span><em>aln</em>, <em>ref_seq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#get_pairs_with_hp_len"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.get_pairs_with_hp_len" title="Permalink to this definition">¶</a></dt>
<dd><p>Return generator of pairs in which the qbase is not just the base,
but is decorated with extra information. E.g. an A which is part of a basecalled
6mer HP would be AAAAAA.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>aln</strong> – <cite>pysam.AlignedSegment</cite> object.</li>
<li><strong>ref_seq</strong> – str containing reference sequence or result of
<cite>seq_to_hp_lens</cite> (ref_seq).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><cite>ComprAlignPos</cite> objects.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.get_sample_index_from_files">
<code class="descclassname">medaka.common.</code><code class="descname">get_sample_index_from_files</code><span class="sig-paren">(</span><em>fnames</em>, <em>filetype='hdf'</em>, <em>max_samples=inf</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#get_sample_index_from_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.get_sample_index_from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Create index of samples from one or more HDF5 or fasta files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fnames</strong> – iterable of str of filepaths.</li>
<li><strong>filetype</strong> – str, ‘hdf’ or ‘fasta’.</li>
<li><strong>max_samples</strong> – int, stop after max_samples.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dict of lists, indexed by reference.
each list contains a list of samples dicts, and is sorted by sample start.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.get_sample_overlap">
<code class="descclassname">medaka.common.</code><code class="descname">get_sample_overlap</code><span class="sig-paren">(</span><em>s1</em>, <em>s2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#get_sample_overlap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.get_sample_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate overlap (in pileup columns) between two <cite>Sample</cite> objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s1</strong> – First <cite>Sample</cite> object.</li>
<li><strong>s2</strong> – Second <cite>Sample</cite> object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(int end1, int start2) such that s1.positions[:end1] could be
concatenated with s2.positions[start2:] to join them without gaps or overlap.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.grouper">
<code class="descclassname">medaka.common.</code><code class="descname">grouper</code><span class="sig-paren">(</span><em>gen</em>, <em>batch_size=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#grouper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.grouper" title="Permalink to this definition">¶</a></dt>
<dd><p>Group together elements of an iterable, yielding remainder without padding.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.lengths_to_rle">
<code class="descclassname">medaka.common.</code><code class="descname">lengths_to_rle</code><span class="sig-paren">(</span><em>lengths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#lengths_to_rle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.lengths_to_rle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.common.load_feature_file">
<code class="descclassname">medaka.common.</code><code class="descname">load_feature_file</code><span class="sig-paren">(</span><em>fname</em>, <em>ref_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#load_feature_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.load_feature_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load <cite>Sample</cite> objects from HDF5.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname</strong> – str, HDF5 filepath.</li>
<li><strong>ref_names</strong> – iterable of str, only fetch samples for this reference.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple of <cite>Sample</cite> objects.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.load_from_feature_files">
<code class="descclassname">medaka.common.</code><code class="descname">load_from_feature_files</code><span class="sig-paren">(</span><em>fnames</em>, <em>key_fnames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#load_from_feature_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.load_from_feature_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield <cite>Sample</cite> objects in order from the result of <cite>save_feature_file</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fnames</strong> – iterable of str of filepaths.</td>
</tr>
<tr class="field-even field"><th class="field-name">Key_fnames:</th><td class="field-body">iterable of (str sample key, fname) tuples.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of <cite>Sample</cite> objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.load_sample_from_hdf">
<code class="descclassname">medaka.common.</code><code class="descname">load_sample_from_hdf</code><span class="sig-paren">(</span><em>key</em>, <em>hdf_fh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#load_sample_from_hdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.load_sample_from_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Load <cite>Sample</cite> object from HDF5</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> – str, sample name.</li>
<li><strong>hdf_fh</strong> – <cite>h5.File</cite> object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><cite>Sample</cite> object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.load_yaml_data">
<code class="descclassname">medaka.common.</code><code class="descname">load_yaml_data</code><span class="sig-paren">(</span><em>fname</em>, <em>group</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#load_yaml_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.load_yaml_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a yml str either from hdf or .yml file</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.mkdir_p">
<code class="descclassname">medaka.common.</code><code class="descname">mkdir_p</code><span class="sig-paren">(</span><em>path</em>, <em>info=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#mkdir_p"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.mkdir_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a directory if it doesn’t exist.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.parse_regions">
<code class="descclassname">medaka.common.</code><code class="descname">parse_regions</code><span class="sig-paren">(</span><em>regions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#parse_regions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.parse_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse region strings into <cite>Region</cite> objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>regions</strong> – iterable of str</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_regions</span><span class="p">([</span><span class="s1">&#39;Ecoli&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Region(ref_name=&#39;Ecoli&#39;, start=None, end=None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parse_regions</span><span class="p">([</span><span class="s1">&#39;Ecoli:1000-2000&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Region(ref_name=&#39;Ecoli&#39;, start=1000, end=2000)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parse_regions</span><span class="p">([</span><span class="s1">&#39;Ecoli:1000&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Region(ref_name=&#39;Ecoli&#39;, start=0, end=1000)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parse_regions</span><span class="p">([</span><span class="s1">&#39;Ecoli:500-&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Region(ref_name=&#39;Ecoli&#39;, start=500, end=None)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="medaka.common.print_data_path">
<code class="descclassname">medaka.common.</code><code class="descname">print_data_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#print_data_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.print_data_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Print data directory containing models</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.rle">
<code class="descclassname">medaka.common.</code><code class="descname">rle</code><span class="sig-paren">(</span><em>array</em>, <em>low_mem=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#rle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.rle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a run length encoding (rle), of an input vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> – 1D input array.</li>
<li><strong>low_mem</strong> – use a lower memory implementation</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>returns: structured array with fields <cite>start</cite>, <cite>length</cite>, and <cite>value</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.sample_to_x_y">
<code class="descclassname">medaka.common.</code><code class="descname">sample_to_x_y</code><span class="sig-paren">(</span><em>s</em>, <em>encoding</em>, <em>max_label_len=inf</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#sample_to_x_y"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.sample_to_x_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a <cite>Sample</cite> object into an x,y tuple for training.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> – <cite>Sample</cite> object.</li>
<li><strong>encoding</strong> – dict of label encodings.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Max_label_len:</th><td class="field-body"><p class="first">int, maximum label length, longer labels will be truncated.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(np.ndarray of inputs, np.ndarray of labels)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.segment_limits">
<code class="descclassname">medaka.common.</code><code class="descname">segment_limits</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>segment_len=20000</em>, <em>overlap_len=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#segment_limits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.segment_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate segments of a range [0, end_point].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> – startpoint of range.</li>
<li><strong>end</strong> – endpoint of range.</li>
<li><strong>segment_len</strong> – length of resultant segments.</li>
<li><strong>overlap_len</strong> – length of overlap between segments.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">tuples (start, end) indicating overlapping segments of
the input range.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.seq_to_hp_lens">
<code class="descclassname">medaka.common.</code><code class="descname">seq_to_hp_lens</code><span class="sig-paren">(</span><em>seq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#seq_to_hp_lens"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.seq_to_hp_lens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return array of HP lengths for every position in the sequence</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>seq</strong> – str, sequence</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><cite>np.ndarray</cite> containing HP lengths (the same length as seq).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.sliding_window">
<code class="descclassname">medaka.common.</code><code class="descname">sliding_window</code><span class="sig-paren">(</span><em>a</em>, <em>window=3</em>, <em>step=1</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#sliding_window"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.sliding_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Sliding window across an array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> – input array.</li>
<li><strong>window</strong> – window length.</li>
<li><strong>step</strong> – step length between consecutive windows.</li>
<li><strong>axis</strong> – axis over which to apply window.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">windows of the input array.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.threadsafe_generator">
<code class="descclassname">medaka.common.</code><code class="descname">threadsafe_generator</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#threadsafe_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.threadsafe_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator that takes a generator function and makes it
thread-safe.</p>
<p><a class="reference external" href="http://anandology.com/blog/using-iterators-and-generators/">http://anandology.com/blog/using-iterators-and-generators/</a></p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.write_sample_to_hdf">
<code class="descclassname">medaka.common.</code><code class="descname">write_sample_to_hdf</code><span class="sig-paren">(</span><em>s</em>, <em>hdf_fh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#write_sample_to_hdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.write_sample_to_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a sample to HDF5.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> – <cite>Sample</cite> object.</li>
<li><strong>hdf_fh</strong> – <cite>h5py.File</cite> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.write_samples_to_hdf">
<code class="descclassname">medaka.common.</code><code class="descname">write_samples_to_hdf</code><span class="sig-paren">(</span><em>fname</em>, <em>samples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#write_samples_to_hdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.write_samples_to_hdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Write samples to hdf, ensuring a sample is not written twice and maintaining</dt>
<dd>a count of labels seen.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fname</strong> – str, output filepath.</li>
<li><strong>samples</strong> – iterable of <cite>Sample</cite> objects.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.write_yaml_data">
<code class="descclassname">medaka.common.</code><code class="descname">write_yaml_data</code><span class="sig-paren">(</span><em>fname</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#write_yaml_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.write_yaml_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a data structure to a yml str either within a hdf or .yml file</p>
</dd></dl>

<dl class="function">
<dt id="medaka.common.yield_batches_from_hdf">
<code class="descclassname">medaka.common.</code><code class="descname">yield_batches_from_hdf</code><span class="sig-paren">(</span><em>h5</em>, <em>keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#yield_batches_from_hdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.yield_batches_from_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield training batches from HDF5.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h5</strong> – <cite>h5.File</cite> object.</li>
<li><strong>keys</strong> – iterable of keys to include in the batch.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">(np.ndarray of inputs, np.ndarray of labels).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.yield_batches_from_hdfs">
<code class="descclassname">medaka.common.</code><code class="descname">yield_batches_from_hdfs</code><span class="sig-paren">(</span><em>handles</em>, <em>batches=None</em>, <em>sparse_labels=True</em>, <em>n_classes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#yield_batches_from_hdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.yield_batches_from_hdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield batches of training features and labels indefinitely, shuffling between epochs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>handles</strong> – {str filename: <cite>h5.File</cite>}.</li>
<li><strong>batches</strong> – iterable of (str filename, str batchname).</li>
<li><strong>sparse_labels</strong> – bool, if False, labels will be one-hot encoded.</li>
<li><strong>n_classes</strong> – int, number of classes for one-hot encoding.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">(np.ndarray of inputs, np.ndarray of labels).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.yield_compressed_pairs">
<code class="descclassname">medaka.common.</code><code class="descname">yield_compressed_pairs</code><span class="sig-paren">(</span><em>aln</em>, <em>ref_rle</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#yield_compressed_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.yield_compressed_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield ComprAlignPos objects for aligned pairs of an AlignedSegment.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>aln</strong> – pysam AlignedSegment.</li>
<li><strong>ref_rle</strong> – structured array with columns ‘start’ and ‘length’ encoding ref.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><cite>ComprAlignPos</cite> objects.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.common.yield_from_feature_files">
<code class="descclassname">medaka.common.</code><code class="descname">yield_from_feature_files</code><span class="sig-paren">(</span><em>fnames</em>, <em>ref_names=None</em>, <em>index=None</em>, <em>samples=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/common.html#yield_from_feature_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.common.yield_from_feature_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield <cite>Sample</cite> objects from one or more feature files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fnames</strong> – iterable of str of filepaths.</td>
</tr>
<tr class="field-even field"><th class="field-name">Ref_names:</th><td class="field-body">iterable of str, only process these references.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Index:</th><td class="field-body">result of <cite>get_sample_index_from_files</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Samples:</th><td class="field-body">iterable of sample names to yield (in order in which they are supplied).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><cite>Sample</cite> objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-medaka.compress">
<span id="medaka-compress-module"></span><h2>medaka.compress module<a class="headerlink" href="#module-medaka.compress" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="medaka.compress.FeatureEncoder">
<em class="property">class </em><code class="descclassname">medaka.compress.</code><code class="descname">FeatureEncoder</code><span class="sig-paren">(</span><em>ref_mode: str = None</em>, <em>max_hp_len: int = 10</em>, <em>log_min: int = None</em>, <em>normalise: str = 'total'</em>, <em>with_depth: bool = False</em>, <em>consensus_as_ref: bool = False</em>, <em>is_compressed: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#FeatureEncoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.FeatureEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to support multiple feature encodings.</p>
<dl class="method">
<dt id="medaka.compress.FeatureEncoder.bam_to_sample">
<code class="descname">bam_to_sample</code><span class="sig-paren">(</span><em>reads_bam</em>, <em>region</em>, <em>ref_rle_fq</em>, <em>read_fraction=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#FeatureEncoder.bam_to_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.FeatureEncoder.bam_to_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a section of an alignment pileup (as shown
by e.g. samtools tview) to a base frequency feature array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>reads_bam</strong> – (sorted indexed) bam with read alignment to reference</li>
<li><strong>region</strong> – <cite>Region</cite> object with ref_name, start and end attributes.</li>
<li><strong>ref_rle_fq</strong> – result of <cite>process_ref_seq</cite></li>
<li><strong>start</strong> – starting position within reference</li>
<li><strong>end</strong> – ending position within reference</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><cite>Sample</cite> object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="medaka.compress.FeatureEncoder.bams_to_training_samples">
<code class="descname">bams_to_training_samples</code><span class="sig-paren">(</span><em>truth_bam</em>, <em>bam</em>, <em>region</em>, <em>ref_rle_fq</em>, <em>chunk_len=1000</em>, <em>overlap=0</em>, <em>read_fraction=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#FeatureEncoder.bams_to_training_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.FeatureEncoder.bams_to_training_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare training data chunks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>truth_bam</strong> – .bam file of truth aligned to ref to generate labels.</li>
<li><strong>bam</strong> – input .bam file.</li>
<li><strong>region</strong> – <cite>Region</cite> obj.
the reference will be parsed.</li>
<li><strong>ref_rle_fq</strong> – path to fastq rle-compressed reference, or result
of <cite>get_runs_from_fastq</cite></li>
<li><strong>chunk_len</strong> – int, chunk length in reference coordinates.</li>
<li><strong>overlap</strong> – int, overlap of adjacent chunks in reference
coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple of <cite>Sample</cite> objects (one item for each input bam) for
each chunk.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Chunks might be missing if <cite>truth_bam</cite> is provided and
regions with multiple mappings were encountered.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="medaka.compress.FeatureEncoder.process_ref_seq">
<code class="descname">process_ref_seq</code><span class="sig-paren">(</span><em>ref_name</em>, <em>ref_fq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#FeatureEncoder.process_ref_seq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.FeatureEncoder.process_ref_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Get encoded reference</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ref_name</strong> – str, name of contig within <cite>ref_fq</cite>.</li>
<li><strong>ref_fq</strong> – path to reference fastq, or <cite>SeqIO.index</cite> obj.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="medaka.compress.alphabet_filter">
<code class="descclassname">medaka.compress.</code><code class="descname">alphabet_filter</code><span class="sig-paren">(</span><em>sample_gen</em>, <em>alphabet=None</em>, <em>filter_labels=True</em>, <em>filter_ref_seq=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#alphabet_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.alphabet_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Skip chunks in which labels and/or ref_seq contain bases not in <cite>alphabet</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sample_gen</strong> – generator of <cite>Sample</cite> named tuples.</li>
<li><strong>alphabet</strong> – set of str of allowed bases. If None, automatically generated from decoding.</li>
<li><strong>filter_labels</strong> – bool, whether to filter on labels.</li>
<li><strong>filter_ref_seq</strong> – bool, whether to filter on ref_seq.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><cite>Sample</cite> named tuples.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.compress.choose_feature_func">
<code class="descclassname">medaka.compress.</code><code class="descname">choose_feature_func</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#choose_feature_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.choose_feature_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.compress.compress">
<code class="descclassname">medaka.compress.</code><code class="descname">compress</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#compress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.compress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.compress.compress_seq">
<code class="descclassname">medaka.compress.</code><code class="descname">compress_seq</code><span class="sig-paren">(</span><em>read</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#compress_seq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.compress_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Compress homopolymers within a basecall, encoding their lengths in qscores.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>read</strong> – <cite>Bio.SeqRecord.SeqRecord</cite> object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(str read.description,
str compressed sequence,
str qscores,
structured array with fields <cite>start</cite>, <cite>length</cite>, and <cite>value</cite>).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.compress.features">
<code class="descclassname">medaka.compress.</code><code class="descname">features</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.features" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.compress.get_label_encoding">
<code class="descclassname">medaka.compress.</code><code class="descname">get_label_encoding</code><span class="sig-paren">(</span><em>max_label_len</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#get_label_encoding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.get_label_encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>Get label encodings for a given maximum label length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>max_label_len</strong> – int, maximum label length.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(label_encoding, label_decoding_strs)
label_encoding: {(int encoded base, int run length): int label encoding}.
label_decoding_strs: list of str of label decodings.</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_label_encoding</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">({(5, 1): 0,</span>
<span class="go">  (5, 2): 1,</span>
<span class="go">  (6, 1): 2,</span>
<span class="go">  (6, 2): 3,</span>
<span class="go">  (7, 1): 4,</span>
<span class="go">  (7, 2): 5,</span>
<span class="go">  (8, 1): 6,</span>
<span class="go">  (8, 2): 7,</span>
<span class="go">  (0, 1): 8,</span>
<span class="go">  },</span>
<span class="go">  [&#39;A&#39;, &#39;AA&#39;, &#39;C&#39;, &#39;CC&#39;, &#39;G&#39;, &#39;GG&#39;, &#39;T&#39;, &#39;TT&#39;, &#39;*&#39;]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="medaka.compress.get_runs_from_fastq">
<code class="descclassname">medaka.compress.</code><code class="descname">get_runs_from_fastq</code><span class="sig-paren">(</span><em>fastq</em>, <em>ref_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#get_runs_from_fastq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.get_runs_from_fastq" title="Permalink to this definition">¶</a></dt>
<dd><p>Get run length encoding of a read.
:param fastq: str, path to fastq file or <cite>SeqIO.index</cite> object.
:param ref_name: str, name of read with fastq.
:returns: structured <cite>numpy.ndarray</cite> with dtype=[(‘start’, int), (‘length’, int)].</p>
</dd></dl>

<dl class="function">
<dt id="medaka.compress.main">
<code class="descclassname">medaka.compress.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.compress.min_positions_filter">
<code class="descclassname">medaka.compress.</code><code class="descname">min_positions_filter</code><span class="sig-paren">(</span><em>sample_gen</em>, <em>min_positions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#min_positions_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.min_positions_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter samples with fewer positions than a minimum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sample_gen</strong> – generator of <cite>Sample</cite> named tuples.</li>
<li><strong>min_positions</strong> – int, samples with fewer positions will be skipped.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><cite>Sample</cite> named tuples</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.compress.training_batches">
<code class="descclassname">medaka.compress.</code><code class="descname">training_batches</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/compress.html#training_batches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.compress.training_batches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-medaka.features">
<span id="medaka-features-module"></span><h2>medaka.features module<a class="headerlink" href="#module-medaka.features" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="medaka.features.alphabet_filter">
<code class="descclassname">medaka.features.</code><code class="descname">alphabet_filter</code><span class="sig-paren">(</span><em>pileup_gen</em>, <em>alphabet=None</em>, <em>filter_labels=True</em>, <em>filter_ref_seq=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/features.html#alphabet_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.features.alphabet_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Skip chunks in which labels and/or ref_seq contain bases not in <cite>alphabet</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pileup_gen</strong> – generator of <cite>LabelledPileup</cite> named tuples.</li>
<li><strong>alphabet</strong> – set of str of allowed bases. If None, automatically generated from decoding.</li>
<li><strong>filter_labels</strong> – bool, whether to filter on labels.</li>
<li><strong>filter_ref_seq</strong> – bool, whether to filter on ref_seq.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><cite>LabelledPileup</cite> named tuples.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.features.counts">
<code class="descclassname">medaka.features.</code><code class="descname">counts</code><span class="sig-paren">(</span><em>pileups</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/features.html#counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.features.counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get counts features for a pileup.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pileups</strong> – iterable of <cite>Pileup</cite> objects</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">np.array of counts features</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.features.depth_filter">
<code class="descclassname">medaka.features.</code><code class="descname">depth_filter</code><span class="sig-paren">(</span><em>pileup_gen</em>, <em>min_depth=15</em>, <em>max_depth=inf</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/features.html#depth_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.features.depth_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate depth (excluding gaps) at every position and skip chunks with depth &lt; <cite>min_depth</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pileup_gen</strong> – generator of <cite>LabelledPileup</cite> named tuples.</li>
<li><strong>min_depth</strong> – int, chunks with insufficient depth at any position will not be yielded.</li>
<li><strong>max_depth</strong> – int, chunks with excessive depth at any position will not be yielded.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><cite>LabelledPileup</cite> named tuples.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.features.pcnt_gap_filter">
<code class="descclassname">medaka.features.</code><code class="descname">pcnt_gap_filter</code><span class="sig-paren">(</span><em>pileup_gen</em>, <em>depth=15</em>, <em>max_pcnt_gap=20.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/features.html#pcnt_gap_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.features.pcnt_gap_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort rows by number of alignment separators (fewest at top), remove any
with more than <cite>max_pcnt_gap</cite> percent gap values, and return
<cite>depth</cite> rows (or all rows if <cite>depth</cite> is None), skipping chunks with insufficient depth.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pileup_gen</strong> – generator of <cite>LabelledPileup</cite> named tuples.</li>
<li><strong>depth</strong> – int, number of rows to return (if None, return all rows).</li>
<li><strong>min_depth</strong> – int, chunks with insufficient depth at any position will not be yielded.</li>
<li><strong>max_pcnt_gap</strong> – float, upper limit of percentage gaps per row tolerated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><cite>LabelledPileup</cite> named tuples.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.features.pileup_and_counts">
<code class="descclassname">medaka.features.</code><code class="descname">pileup_and_counts</code><span class="sig-paren">(</span><em>pileups</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/features.html#pileup_and_counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.features.pileup_and_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get features comprising pileup and counts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pileups</strong> – iterable of <cite>Pileup</cite> objects</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">np.array of counts and pileup features.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-medaka.inference">
<span id="medaka-inference-module"></span><h2>medaka.inference module<a class="headerlink" href="#module-medaka.inference" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="medaka.inference.bam_pileup_to_features_hdf">
<code class="descclassname">medaka.inference.</code><code class="descname">bam_pileup_to_features_hdf</code><span class="sig-paren">(</span><em>hdf</em>, <em>bams</em>, <em>ref_fasta</em>, <em>ref_name: str = None</em>, <em>start: int = 0</em>, <em>end: int = None</em>, <em>truth_bam=None</em>, <em>chunk_len=1000</em>, <em>overlap=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#bam_pileup_to_features_hdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.bam_pileup_to_features_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an .hdf file of features for training or inference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hdf</strong> – output .hdf file (will be overwritten).</li>
<li><strong>bams</strong> – iterable of input .bam files.</li>
<li><strong>ref_fasta</strong> – input .fasta file.</li>
<li><strong>ref_name</strong> – name of reference within .bam to parse.</li>
<li><strong>start</strong> – start reference coordinate.</li>
<li><strong>end</strong> – end reference coordinate. If <cite>None</cite> the full extent of
the reference will be parsed.</li>
<li><strong>truth_bam</strong> – .bam file of truth aligned to ref to generate labels.</li>
<li><strong>chunk_len</strong> – int, chunk length in pileup columns.</li>
<li><strong>overlap</strong> – int, overlap of adjacent chunks in pileup columns.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.inference.build_model">
<code class="descclassname">medaka.inference.</code><code class="descname">build_model</code><span class="sig-paren">(</span><em>chunk_size</em>, <em>feature_len</em>, <em>num_classes</em>, <em>gru_size=128</em>, <em>input_dropout=0.0</em>, <em>inter_layer_dropout=0.0</em>, <em>recurrent_dropout=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a bidirectional GRU model
:param chunk_size: int, number of pileup columns in a sample.
:param feature_len: int, number of features for each pileup column.
:param num_classes: int, number of output class labels.
:param gru_size: int, size of each GRU layer.
:param input_dropout: float, fraction of the input feature-units to drop.
:param inter_layer_dropout: float, fraction of units to drop between layers.
:param recurrent_dropout: float, fraction of units to drop within the recurrent state.
:returns: <cite>keras.models.Sequential</cite> object.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.inference.generate_samples">
<code class="descclassname">medaka.inference.</code><code class="descname">generate_samples</code><span class="sig-paren">(</span><em>pileup_gen</em>, <em>coverage_filter=&lt;function &lt;lambda&gt;&gt;</em>, <em>feature_func=&lt;function counts&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#generate_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.generate_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate data samples from a pileup generator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pileup_gen</strong> – generator of (pileups, labels) tuples;
pileups: list of <cite>Pileup</cite> objects
labels: np.array of labels or None.</li>
<li><strong>feature_func</strong> – function to generate features</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>:yields <cite>Sample</cite> objects.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.inference.predict">
<code class="descclassname">medaka.inference.</code><code class="descname">predict</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference program.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.inference.prepare">
<code class="descclassname">medaka.inference.</code><code class="descname">prepare</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#prepare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.prepare" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.inference.process_labels">
<code class="descclassname">medaka.inference.</code><code class="descname">process_labels</code><span class="sig-paren">(</span><em>label_counts</em>, <em>max_label_len=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#process_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.process_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Create map from full labels to (encoded) truncated labels.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.inference.qscore">
<code class="descclassname">medaka.inference.</code><code class="descname">qscore</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#qscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.qscore" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.inference.run_prediction">
<code class="descclassname">medaka.inference.</code><code class="descname">run_prediction</code><span class="sig-paren">(</span><em>sample_gen</em>, <em>model</em>, <em>label_decoding</em>, <em>output_file='consensus_chunks.fa'</em>, <em>batch_size=200</em>, <em>predictions_file=None</em>, <em>n_samples=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#run_prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.run_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.inference.run_training">
<code class="descclassname">medaka.inference.</code><code class="descname">run_training</code><span class="sig-paren">(</span><em>train_name</em>, <em>sample_gen</em>, <em>valid_gen</em>, <em>n_batch_train</em>, <em>n_batch_valid</em>, <em>label_decoding</em>, <em>timesteps</em>, <em>feat_dim</em>, <em>model_fp=None</em>, <em>epochs=5000</em>, <em>batch_size=100</em>, <em>class_weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#run_training"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.run_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Run training.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.inference.train">
<code class="descclassname">medaka.inference.</code><code class="descname">train</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Training program.</p>
</dd></dl>

<dl class="function">
<dt id="medaka.inference.weighted_categorical_crossentropy">
<code class="descclassname">medaka.inference.</code><code class="descname">weighted_categorical_crossentropy</code><span class="sig-paren">(</span><em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/inference.html#weighted_categorical_crossentropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.inference.weighted_categorical_crossentropy" title="Permalink to this definition">¶</a></dt>
<dd><p>A weighted version of keras.objectives.categorical_crossentropy
&#64;url: <a class="reference external" href="https://gist.github.com/wassname/ce364fddfc8a025bfab4348cf5de852d">https://gist.github.com/wassname/ce364fddfc8a025bfab4348cf5de852d</a>
&#64;author: wassname</p>
<dl class="docutils">
<dt>Variables:</dt>
<dd>weights: numpy array of shape (C,) where C is the number of classes</dd>
<dt>Usage:</dt>
<dd>weights = np.array([0.5,2,10]) # Class one at 0.5, class 2 twice the normal weights, class 3 10x.
loss = weighted_categorical_crossentropy(weights)
model.compile(loss=loss,optimizer=’adam’)</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-medaka.labels">
<span id="medaka-labels-module"></span><h2>medaka.labels module<a class="headerlink" href="#module-medaka.labels" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="medaka.labels.TruthAlignment">
<em class="property">class </em><code class="descclassname">medaka.labels.</code><code class="descname">TruthAlignment</code><span class="sig-paren">(</span><em>alignment</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/labels.html#TruthAlignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.labels.TruthAlignment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="staticmethod">
<dt id="medaka.labels.TruthAlignment.bam_to_alignments">
<em class="property">static </em><code class="descname">bam_to_alignments</code><span class="sig-paren">(</span><em>truth_bam</em>, <em>ref_name</em>, <em>start=None</em>, <em>end=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/labels.html#TruthAlignment.bam_to_alignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.labels.TruthAlignment.bam_to_alignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Create list of TruthAlignment objects from a bam of Truth aligned to ref.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>truth_bam</strong> – (sorted indexed) bam with true sequence aligned to reference</li>
<li><strong>ref</strong> – name of reference to process</li>
<li><strong>start</strong> – starting position within reference</li>
<li><strong>end</strong> – ending position within reference
(all alignments with any overlap with the interval start:end will be retrieved)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>tuple(positions, encoded_label_array)</p>
<ul class="simple">
<li>positions: numpy structured array with ‘ref_major’
(reference position index) and ‘ref_minor’
(trailing insertion index) fields.</li>
<li>feature_array: 1D numpy array of encoded labels</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="medaka.labels.TruthAlignment.filter_alignments">
<em class="property">static </em><code class="descname">filter_alignments</code><span class="sig-paren">(</span><em>alignments</em>, <em>min_length=1000</em>, <em>length_ratio=2.0</em>, <em>overlap_fraction=0.5</em>, <em>start=0</em>, <em>end=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/labels.html#TruthAlignment.filter_alignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.labels.TruthAlignment.filter_alignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter alignments to yield only segments suitable for training.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>alignments</strong> – iterable of <cite>TruthAlignment</cite> objects.</li>
<li><strong>min_length</strong> – int, minimum length of alignment segment.</li>
<li><strong>length_ratio</strong> – float, in cases of overlap, ratio of longer segment / shorter segment
above which the longer segment is assumed to be more reliable.</li>
<li><strong>overlap_fraction</strong> – float, length_ratio: float, in cases of overlap, fraction of
shorter segment overlapping with the longer segment above which the segments are
considered highly overlapping.</li>
<li><strong>start</strong> – zero-based start position in reference coordinates. Any alignments which
start before this value will take this new starting coordinate.</li>
<li><strong>end</strong> – zero-based end position in reference coordinates. and alignments
which end after this value will take this new ending coordinate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of <cite>TruthAlignment</cite> objects</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="medaka.labels.TruthAlignment.get_overlap_with">
<code class="descname">get_overlap_with</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/labels.html#TruthAlignment.get_overlap_with"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.labels.TruthAlignment.get_overlap_with" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="medaka.labels.TruthAlignment.get_positions_and_labels">
<code class="descname">get_positions_and_labels</code><span class="sig-paren">(</span><em>start=None</em>, <em>end=None</em>, <em>ref_compr_rle=None</em>, <em>mock_compr=False</em>, <em>is_compressed=False</em>, <em>rle_dtype=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/labels.html#TruthAlignment.get_positions_and_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.labels.TruthAlignment.get_positions_and_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Create labels and positions array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> – starting position within reference</li>
<li><strong>end</strong> – ending position within reference</li>
<li><strong>ref_compr_rle</strong> – np.ndarray, dtype [(‘start’, int), (‘end’, int)]
containing uncompressed start position and length for each compressed position.</li>
<li><strong>mock_compr</strong> – bool, labels will be encoded as for a compressed sequence, even if ref_compr_rle is None.</li>
<li><strong>is_compressed</strong> – bool, whether the sequence has been run length encoded.</li>
<li><strong>rle_dtype</strong> – bool, whether to force dtype of labels to be (int base , int length).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>tuple(positions, encoded_label_array)</p>
<ul class="simple">
<li>positions: numpy structured array with ‘ref_major’
(reference position index) and ‘ref_minor’
(trailing insertion index) fields.</li>
<li>labels_array: 1D numpy array of labels</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-medaka.medaka">
<span id="medaka-medaka-module"></span><h2>medaka.medaka module<a class="headerlink" href="#module-medaka.medaka" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="medaka.medaka.fix">
<code class="descclassname">medaka.medaka.</code><code class="descname">fix</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/medaka.html#fix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.medaka.fix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.medaka.main">
<code class="descclassname">medaka.medaka.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/medaka.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.medaka.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-medaka.stitch">
<span id="medaka-stitch-module"></span><h2>medaka.stitch module<a class="headerlink" href="#module-medaka.stitch" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="medaka.stitch.merge_into_sequence">
<code class="descclassname">medaka.stitch.</code><code class="descname">merge_into_sequence</code><span class="sig-paren">(</span><em>existing</em>, <em>incoming</em>, <em>overlap_length</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/stitch.html#merge_into_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.stitch.merge_into_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Append string to another string using pairwise alignment of
overlapping ends to select join</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>existing</strong> – str growing sequence</li>
<li><strong>incoming</strong> – str new sequence to be appended</li>
<li><strong>overlap_length</strong> – int length of overlap between sequence ends</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">str new sequence</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">reproduced almost verbatim from
<a class="reference external" href="https://github.com/jts/nanopolish/blob/master/scripts/nanopolish_merge.py">nanopolish_merge</a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="medaka.stitch.stitch">
<code class="descclassname">medaka.stitch.</code><code class="descname">stitch</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/stitch.html#stitch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.stitch.stitch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="medaka.stitch.stitch_from_fastas">
<code class="descclassname">medaka.stitch.</code><code class="descname">stitch_from_fastas</code><span class="sig-paren">(</span><em>fastas</em>, <em>min_overlap_len=50</em>, <em>ref_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/stitch.html#stitch_from_fastas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.stitch.stitch_from_fastas" title="Permalink to this definition">¶</a></dt>
<dd><p>Join overlapping sequences to assemble complete sequence</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fastas</strong> – iterable of fasta filepaths.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Min_overlap_len:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">int, minimum required overlap in reference positions at sequence ends</td>
</tr>
<tr class="field-odd field"><th class="field-name">Ref_names:</th><td class="field-body">iterable of ref_names to limit stitching to.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of (contig_name, sequence)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.stitch.stitch_from_probs">
<code class="descclassname">medaka.stitch.</code><code class="descname">stitch_from_probs</code><span class="sig-paren">(</span><em>probs_hdfs</em>, <em>ref_names=None</em>, <em>model_yml=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/stitch.html#stitch_from_probs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.stitch.stitch_from_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode and join overlapping label probabilities from hdf to assemble complete sequence</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>probs_hdfs</strong> – iterable of hdf filepaths.</td>
</tr>
<tr class="field-even field"><th class="field-name">Ref_names:</th><td class="field-body">iterable of ref_names to limit stitching to.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of (contig_name, sequence)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.stitch.write_fasta">
<code class="descclassname">medaka.stitch.</code><code class="descname">write_fasta</code><span class="sig-paren">(</span><em>filename</em>, <em>contigs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/stitch.html#write_fasta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.stitch.write_fasta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-medaka.tview">
<span id="medaka-tview-module"></span><h2>medaka.tview module<a class="headerlink" href="#module-medaka.tview" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="medaka.tview.MultiTView">
<em class="property">class </em><code class="descclassname">medaka.tview.</code><code class="descname">MultiTView</code><span class="sig-paren">(</span><em>bams: Tuple[str], reference: str, columns: int = 20000, cache: int = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#MultiTView"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.MultiTView" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="medaka.tview.MultiTView.pileup">
<code class="descname">pileup</code><span class="sig-paren">(</span><em>ref_name: str</em>, <em>start: int = 0</em>, <em>end: int = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#MultiTView.pileup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.MultiTView.pileup" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce aligned pileups spanning a reference region as a numpy
array, along with some meta information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ref_name</strong> – name of reference to which reads are aligned.</li>
<li><strong>start</strong> – start position in reference coordinates.</li>
<li><strong>end</strong> – end position in reference coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a tuple of <cite>Pileup</cite> tuples</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="medaka.tview.RawTView">
<code class="descclassname">medaka.tview.</code><code class="descname">RawTView</code><a class="headerlink" href="#medaka.tview.RawTView" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#medaka.tview.TView" title="medaka.tview.TView"><code class="xref py py-class docutils literal notranslate"><span class="pre">medaka.tview.TView</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="medaka.tview.TView">
<em class="property">class </em><code class="descclassname">medaka.tview.</code><code class="descname">TView</code><span class="sig-paren">(</span><em>bam: str</em>, <em>reference: str</em>, <em>columns: int = 20000</em>, <em>cache: int = None</em>, <em>minor_gaps: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#TView"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.TView" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="medaka.tview.TView.pileup">
<code class="descname">pileup</code><span class="sig-paren">(</span><em>ref_name: str</em>, <em>start: int = 0</em>, <em>end: int = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#TView.pileup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.TView.pileup" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the read pileup spanning a reference region as a numpy array,
along with some meta information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ref_name</strong> – name of reference to which reads are aligned.</li>
<li><strong>start</strong> – start position in reference coordinates.</li>
<li><strong>end</strong> – end position in reference coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><cite>Pileup</cite> tuples</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="medaka.tview.TViewException">
<em class="property">exception </em><code class="descclassname">medaka.tview.</code><code class="descname">TViewException</code><a class="reference internal" href="_modules/medaka/tview.html#TViewException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.TViewException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="function">
<dt id="medaka.tview.generate_pileup_chunks">
<code class="descclassname">medaka.tview.</code><code class="descname">generate_pileup_chunks</code><span class="sig-paren">(</span><em>bams</em>, <em>ref_fasta</em>, <em>ref_name</em>, <em>start=0</em>, <em>end=None</em>, <em>chunk_len=50000</em>, <em>overlap=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#generate_pileup_chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.generate_pileup_chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield chunks of pileup(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bams</strong> – iterable of input .bam files.</li>
<li><strong>ref_fasta</strong> – input .fasta file.</li>
<li><strong>ref_name</strong> – name of reference within .bam to parse.</li>
<li><strong>start</strong> – start reference coordinate.</li>
<li><strong>end</strong> – end reference coordinate. If <cite>None</cite> the full extent of
the reference will be parsed.</li>
<li><strong>chunk_len</strong> – int, chunk length in reference coordinates.</li>
<li><strong>overlap</strong> – int, overlap of adjacent chunks in reference coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">(tuple <cite>Pileup</cite> objects, None)</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>..note:: the None in the yielded values is for compatibility with an</dt>
<dd>old API and will be removed.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="medaka.tview.generate_training_chunks">
<code class="descclassname">medaka.tview.</code><code class="descname">generate_training_chunks</code><span class="sig-paren">(</span><em>truth_bam</em>, <em>bams</em>, <em>ref_fasta</em>, <em>ref_name</em>, <em>start=0</em>, <em>end=None</em>, <em>chunk_len=50000</em>, <em>overlap=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#generate_training_chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.generate_training_chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare training data chunks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>truth_bam</strong> – .bam file of truth aligned to ref to generate labels.</li>
<li><strong>bams</strong> – iterable of input .bam files.</li>
<li><strong>ref_fasta</strong> – input .fasta file.</li>
<li><strong>ref_name</strong> – name of reference within .bam to parse.</li>
<li><strong>start</strong> – start reference coordinate.</li>
<li><strong>end</strong> – end reference coordinate. If <cite>None</cite> the full extent of
the reference will be parsed.</li>
<li><strong>chunk_len</strong> – int, chunk length in reference coordinates.</li>
<li><strong>overlap</strong> – int, overlap of adjacent chunks in reference coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">tuple of <cite>Pileup</cite> objects (one item for each input bam) for each
chunk.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Chunks might be missing if <cite>truth_bam</cite> is provided and
regions with multiple mappings were encountered.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="medaka.tview.join_read_seps">
<code class="descclassname">medaka.tview.</code><code class="descname">join_read_seps</code><span class="sig-paren">(</span><em>pileup_row</em>, <em>read_sep</em>, <em>gap_val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#join_read_seps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.join_read_seps" title="Permalink to this definition">¶</a></dt>
<dd><p>Join up <cite>read_sep`s converting any surrounding `gap_val`s with `read_sep`s.
i.e. in substrings containing only `read_sep</cite> and <cite>gap_val</cite>, replace all
<cite>gap_val</cite> with <cite>read_sep</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pileup_row</strong> – np.array of input data.</li>
<li><strong>read_sep</strong> – permitted gap symbol.</li>
<li><strong>gap_val</strong> – symbol to be replaced by <cite>read_sep</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">np.array of modified pileup_row</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">join_read_seps</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="s1">&#39;*C*AA***  *  *** GGA&#39;</span><span class="p">]),</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">))</span>
<span class="go">&#39;*C*AA            GGA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">join_read_seps</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="s1">&#39;*C*AA*** &#39;</span><span class="p">]),</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">))</span>
<span class="go">&#39;*C*AA    &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">join_read_seps</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="s1">&#39;*C*AA***&#39;</span><span class="p">]),</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">))</span>
<span class="go">&#39;*C*AA***&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="medaka.tview.load_pileup">
<code class="descclassname">medaka.tview.</code><code class="descname">load_pileup</code><span class="sig-paren">(</span><em>pileup_hdf</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#load_pileup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.load_pileup" title="Permalink to this definition">¶</a></dt>
<dd><p>Load hdf pileup yielding chunks of pileup.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hdf</strong> – input .hdf file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><cite>(pileups, labels)</cite> for each chunk;
<cite>pileups</cite>: a list of <cite>Pileup</cite> objects
<cite>labels</cite>: array of truth labels or <cite>None</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.tview.rechunk">
<code class="descclassname">medaka.tview.</code><code class="descname">rechunk</code><span class="sig-paren">(</span><em>pileup_gen</em>, <em>chunk_size=1000</em>, <em>overlap=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#rechunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.rechunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Rechunk chunks of pileup into smaller overlapping chunks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pileup_gen</strong> – generator of (pileups, labels);
pileups: a list of <cite>Pileup</cite> objects
labels: array of truth labels or <cite>None</cite>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body">(pileups, labels)
pileups: a list of <cite>Pileup</cite> objects
labels: array of truth labels or <cite>None</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.tview.reindex_labels">
<code class="descclassname">medaka.tview.</code><code class="descname">reindex_labels</code><span class="sig-paren">(</span><em>truth</em>, <em>new_positions</em>, <em>max_label_len=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#reindex_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.reindex_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate labels from a truth pileup and positions (of some other
pileup).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>truth</strong> – <cite>Pileup</cite> object</li>
<li><strong>pileups</strong> – list of <cite>Pileup</cite> objects</li>
<li><strong>new_positions</strong> – structured array of new positions with ‘major’ and
‘minor’ fields.</li>
<li><strong>max_label_len</strong> – int, where we have no evidence in the pileup (and
hence ref) for a base which is present in the truth, we want the
label for the previous base to include the missing bases up to
<cite>max_label_len</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">np.array of labels</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="medaka.tview.reindex_pileup">
<code class="descclassname">medaka.tview.</code><code class="descname">reindex_pileup</code><span class="sig-paren">(</span><em>pileup</em>, <em>new_positions</em>, <em>minor_gaps=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/medaka/tview.html#reindex_pileup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medaka.tview.reindex_pileup" title="Permalink to this definition">¶</a></dt>
<dd><p>Reindex pileup and fix any gaps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pileup</strong> – Pileup obj with <cite>reads</cite> and <cite>positions</cite> attributes.</li>
<li><strong>new_positions</strong> – iterable of tuples (e.g. structured numpy array) of
new minor and major positions.</li>
<li><strong>minor_gaps</strong> – used distinct encoding for gaps in minor positions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pileup obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-medaka">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-medaka" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="future.html" class="btn btn-neutral" title="History and Future Directions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Oxford Nanopore Technologies.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>